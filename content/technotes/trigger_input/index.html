

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Connecting external Trigger Input &mdash; ARRUS Toolkit  documentation</title>
  

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script src="../../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Utils" href="../../utils.html" />
    <link rel="prev" title="Color and Power Doppler" href="../doppler/index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index.html" class="icon icon-home" alt="Documentation Home"> ARRUS Toolkit
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">User Documentation</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installation/index.html">Installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Technotes</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../connecting_custom_probe/index.html">Connecting custom probe</a></li>
<li class="toctree-l2"><a class="reference internal" href="../doppler/index.html">Color and Power Doppler</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Connecting external Trigger Input</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#intended-use">Intended use</a></li>
<li class="toctree-l3"><a class="reference internal" href="#requirements">Requirements</a></li>
<li class="toctree-l3"><a class="reference internal" href="#installation">Installation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#parameters">Parameters</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#general-purpose-signal-generator">General-purpose signal generator</a></li>
<li class="toctree-l4"><a class="reference internal" href="#python-scripts">Python scripts</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#how-to-run">How to run</a></li>
<li class="toctree-l3"><a class="reference internal" href="#utils">Utils</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../utils.html">Utils</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api.html">API Reference</a></li>
</ul>
<p class="caption"><span class="caption-text">Miscellaneous</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../misc/acknowledgments.html">Acknowledgments</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">ARRUS Toolkit</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../index.html">Technotes</a> &raquo;</li>
        
      <li>Connecting external Trigger Input</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="connecting-external-trigger-input">
<h1>Connecting external Trigger Input<a class="headerlink" href="#connecting-external-trigger-input" title="Permalink to this headline">¶</a></h1>
<p>In this document we present instructions on how to connect and use an external
trigger generator with the us4us ultrasound systems.</p>
<p>This document describes ARRUS-Toolkit example: <code class="docutils literal notranslate"><span class="pre">common/trigger_input</span></code></p>
<div class="section" id="intended-use">
<h2>Intended use<a class="headerlink" href="#intended-use" title="Permalink to this headline">¶</a></h2>
<p>The instruction and example provided here can be applied for whatever application
it is necessary to synchronize the ultrasound system with an external trigger
signal, such as: photo-acoustic imaging, externally controlled transmissions, etc.</p>
<p>The example described here provides access to the raw channel data (RF).</p>
</div>
<div class="section" id="requirements">
<h2>Requirements<a class="headerlink" href="#requirements" title="Permalink to this headline">¶</a></h2>
<p>Hardware:</p>
<ul class="simple">
<li><p>us4R-lite+ system</p></li>
<li><p>General-purpose signal generator</p></li>
</ul>
<p>Software:</p>
<ul class="simple">
<li><p>ARRUS Python &gt;= 0.11.0</p></li>
<li><p>gui4us &gt;= 0.3.0-dev20241008</p></li>
</ul>
</div>
<div class="section" id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h2>
<p>Hardware:</p>
<ul class="simple">
<li><p>Connect the signal generator output to the ultrasound system “TRIG IN” port.</p></li>
<li><p>Connect the ultrasound system “CLK OUT” port to the signal generator clock input.</p></li>
</ul>
<p>Software:</p>
<ol class="arabic simple">
<li><p>Download the <a class="reference external" href="https://github.com/us4useu/arrus-toolkit/tree/master/examples/common/trigger_input">trigger_input</a> example (the whole directory).</p></li>
<li><p>Update the <code class="docutils literal notranslate"><span class="pre">us4r.prototxt</span></code>: set the proper probe adapter name, probe name, HV model name.</p></li>
</ol>
</div>
<div class="section" id="parameters">
<h2>Parameters<a class="headerlink" href="#parameters" title="Permalink to this headline">¶</a></h2>
<div class="section" id="general-purpose-signal-generator">
<h3>General-purpose signal generator<a class="headerlink" href="#general-purpose-signal-generator" title="Permalink to this headline">¶</a></h3>
<div class="admonition caution">
<p class="admonition-title">Caution</p>
<p>When a high frequency value is used (&gt;= 100 Hz), we recommend setting the
n_frames value also sufficiently high (e.g. 100 frames for 100 Hz)
to mitigate the overhead caused by starting and stopping the transfer
via the interface between the system and the host PC.</p>
<p>See also the <code class="docutils literal notranslate"><span class="pre">Python</span> <span class="pre">scripts</span></code> section for more information.</p>
</div>
<table class="docutils align-default">
<colgroup>
<col style="width: 9%" />
<col style="width: 91%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Value</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Frequency</p></td>
<td><p>In accordance with user requirements (max 10 kHz).</p></td>
</tr>
<tr class="row-odd"><td><p>Amplitude</p></td>
<td><p>Please see <a class="reference external" href="https://us4useu.github.io/us4r-user-docs/">us4R</a>/<a class="reference external" href="https://us4useu.github.io/us4r-lite-user-docs/">us4R-lite</a> user manual.</p></td>
</tr>
<tr class="row-even"><td><p>Waveform</p></td>
<td><p>Pulse</p></td>
</tr>
<tr class="row-odd"><td><p>Pulse Width</p></td>
<td><p>10 us</p></td>
</tr>
<tr class="row-even"><td><p>Rise edge</p></td>
<td><p>~ 9 ns</p></td>
</tr>
<tr class="row-odd"><td><p>Load</p></td>
<td><p>Please see <a class="reference external" href="https://us4useu.github.io/us4r-user-docs/">us4R</a>/<a class="reference external" href="https://us4useu.github.io/us4r-lite-user-docs/">us4R-lite</a> user manual.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="python-scripts">
<h3>Python scripts<a class="headerlink" href="#python-scripts" title="Permalink to this headline">¶</a></h3>
<p>The below parameters can be changed in the <code class="docutils literal notranslate"><span class="pre">common/trigger_input/env.py</span></code>
script file, in the section e.g.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># ------------ PARAMETERS</span>
<span class="n">n_samples</span> <span class="o">=</span> <span class="mi">2048</span>
<span class="n">n_frames</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">tx_aperture</span> <span class="o">=</span> <span class="p">[</span><span class="kc">True</span><span class="p">]</span><span class="o">*</span><span class="n">n_elements</span>
<span class="n">tx_delays</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">tx_aperture</span><span class="p">)</span>
<span class="c1"># -------------</span>
</pre></div>
</div>
<table class="docutils align-default">
<colgroup>
<col style="width: 14%" />
<col style="width: 86%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>n_frames</p></td>
<td><p>Number of logical frames to be acquired in a single data transfer.</p>
<p>One logical frame may be translated into multiple physical TX/RX operations,</p>
<p>depending on the number of elements in your transducer and the number of RX</p>
<p>channels available in the ultrasonic system.</p>
<p>For example, if 128 elements of the probe are used in RX on the system with</p>
<p>64 RX channels, the observed frame rate will be halved.</p>
<p>This value should be selected according to the chosen signal generator frequency.</p>
<p>When high frequency values are used (&gt;= 100 Hz), we recommend setting the number</p>
<p>of frames also sufficiently high to mitigate the overhead caused by starting</p>
<p>and stopping the transfer via the interface between the system and the host PC.</p>
</td>
</tr>
<tr class="row-odd"><td><p>tx_aperture</p></td>
<td><p>TX aperture definition.</p>
<p>The TX aperture should be defined as boolean array (mask) for selected probe</p>
<p>elements to be used in TX.</p>
<p>For the photo-acoustic application, please consider setting this value</p>
<p>to <code class="docutils literal notranslate"><span class="pre">[False]*n_elements</span></code>.</p>
</td>
</tr>
<tr class="row-even"><td><p>n_samples</p></td>
<td><p>Number of samples to acquire in a single RX (RF frame). This value determines</p>
<p>imaging maximum depth.</p>
</td>
</tr>
</tbody>
</table>
<p>We also encourage you to modify other parameters of the TX/RX sequence in the env.py file.
For more information, please refer to the documentation for your version of <a class="reference external" href="https://github.com/us4useu/arrus/releases">ARRUS</a>.</p>
</div>
</div>
<div class="section" id="how-to-run">
<h2>How to run<a class="headerlink" href="#how-to-run" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple">
<li><p>Turn on the appropriate output of the signal generator.</p></li>
<li><p>Start the example, please execute the following command in the terminal:</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gui4us</span> <span class="o">--</span><span class="n">cfg</span> <span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">examples</span><span class="o">/</span><span class="n">common</span><span class="o">/</span><span class="n">trigger_input</span>
</pre></div>
</div>
<p>After successfully launching the application, a window like the one below should appear.</p>
<div class="figure align-default">
<img alt="../../../_images/trigger_off.png" src="../../../_images/trigger_off.png" />
</div>
<ol class="arabic simple" start="3">
<li><p>Press Start button.</p></li>
</ol>
<p>After running the example, the presented RF data should be updated with the frame
according to the frequency set on the generator.</p>
<div class="figure align-default">
<img alt="../../../_images/trigger_on.png" src="../../../_images/trigger_on.png" />
</div>
<p>You can acquire data by pressing <code class="docutils literal notranslate"><span class="pre">Capture</span></code> button, then by pressing <code class="docutils literal notranslate"><span class="pre">Save</span></code>.
The data will be saved in the current working directory (i.e. the currently
visited folder in the terminal).</p>
<p>To stop the TX/RX sequence, please close the GUI4us window.</p>
</div>
<div class="section" id="utils">
<h2>Utils<a class="headerlink" href="#utils" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">analyse.ipynb</span></code> notebook shows how to read the data acquired using
the gui4us capture buffer.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../../utils.html" class="btn btn-neutral float-right" title="Utils" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../doppler/index.html" class="btn btn-neutral float-left" title="Color and Power Doppler" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2025, us4us Ltd

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>